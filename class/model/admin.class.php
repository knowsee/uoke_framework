<?phpif (!defined('IN_UOKE')) {    exit('Wrong!!');}class Model_Admin extends Model {    public $getInput = array();    protected $pageNum = '10';    protected $defaultTemplate = 'admin/index';    protected $privateUri = array(        'systemRunUri' => 'adminStatus.php?act=systemUpdate',        'baseRunUri' => 'adminStatus.php?act=setCash',        'ajaxSearchUri' => 'adminStatus.php?act=getInfo&model=searchClient'    );    public function default_Action() {        $baseInfo = control_systemBase::getSystemBase();        list(, $list) = $baseLog = control_systemBase::getLogList(1, 10);        $this->modelDisplay(array('baseInfo' => $baseInfo, 'baseLogList' => $list));    }    public function setCash_Action() {        if (app::v('checkallow', 'submit')) {            if (!$this->getInput['clientMoney']) {                showmsg(control_returnCode::PROJECT_MONEY_FAIL);            }            $user = control_user::getUserInfo($this->getInput['clientId']);            if ($this->getInput['clientId'] && !$user) {                showmsg(control_returnCode::REG_ERROR_NOTFOUND);            } elseif ($this->getInput['clientId']) {                $userBasePlan = control_userBase::getUserPlanByUserId($this->getInput['projectId'], $user[control_user::TABLE_KEY]);                if (!$userBasePlan) {                    control_userBase::makeUserPlan(0, $this->getInput['projectId'], $user[control_user::TABLE_KEY]);                }            }            switch ($this->getInput['cashType']) {                case 'outcash_in':                    $cashDo = 'add';                    break;                case 'outcash_out':                    $cashDo = 'reduce';                    break;                case 'incash_in':                    $cashDo = 'add';                    break;                case 'incash_out':                    $cashDo = 'reduce';                    break;            }            $projectId = $this->getInput['projectId'];            switch ($this->getInput['doProject']) {                case 'add':                    $projectId = control_baseMoney::makeBaseInfo(array(                                control_baseMoney::TABLE_KEYNAME => $this->getInput['projectName'],                                control_baseMoney::TABLE_BASEMONEY => $this->getInput['clientMoney'],                                control_baseMoney::TABLE_RUNMONEY => $this->getInput['clientMoney'],                                control_baseMoney::TABLE_CLIENTMONEY => $this->getInput['clientMoney'],                    ));                    break;                case 'edit':                    control_baseMoney::editBaseInfo(array(                        control_baseMoney::TABLE_KEYNAME => $this->getInput['projectName'],                            ), $projectId);                    break;                case 'setcash':                    control_baseMoney::editCash($projectId, $this->getInput['clientMoney'], $cashDo);                    break;            }            switch ($this->getInput['cashType']) {                case 'outcash_in':                    control_userBase::pushMoneyByUserId($this->getInput['clientMoney'], $projectId, $user[control_user::TABLE_KEY], $cashDo);                    break;                case 'outcash_out':                    control_userBase::pushMoneyByUserId($this->getInput['clientMoney'], $projectId, $user[control_user::TABLE_KEY], $cashDo);                    break;            }            showmsg(control_returnCode::FORM_SUBMIT_TRUE);        } else {            list(, $list) = control_baseMoney::getList(1, 50);            $this->defaultTemplate = 'admin/moneyCash';            $this->modelDisplay(array('baselist' => $list));        }    }    /*     * ajax拉取信息     *      * ajaxGet 规范： ajaxId为该模块的ID；     */    public function getInfo_Action() {        $model = $this->getInput['model'];        switch ($model) {            case 'project':                $baseInfo = control_baseMoney::getBaseInfo(intval($this->getInput['ajaxId']));                showmsg(control_returnCode::ALWAYS_TRUE, array(                    'baseName' => $baseInfo[control_baseMoney::TABLE_KEYNAME],                    'baseMoney' => $baseInfo[control_baseMoney::TABLE_BASEMONEY],                    'runMoney' => $baseInfo[control_baseMoney::TABLE_RUNMONEY],                ));                break;            case 'projectlog':                list($total, $baseLogInfo) = control_baseMoney::getLogList(intval($this->getInput['ajaxId']), 1, 10);                $this->defaultTemplate = 'admin/project/log';                $this->modelDisplay(array('baseLogInfo' => $baseLogInfo));                break;            case 'searchClient':                $query = $this->getInput['query'];                list($total, $list) = control_user::getListByKeyword($query, 1, 10);                foreach ($list as $user) {                    $jsonList[] = array('keyName' => $user[control_user::TABLE_REALNAME], 'key' => (string) $user[control_user::TABLE_UNIONKEY]);                }                echo json_encode($jsonList);                break;            default :                showmsg(control_returnCode::AJAX_GET_NOMODEL);                break;        }    }    public function systemUpdate_Action() {        if (app::v('checkallow', 'submit')) {            foreach (control_systemBase::getMoneyArray() as $key => $val) {                $baseInfo[$key] = $this->getInput[$key];            }            control_systemBase::updateSystemBase($baseInfo);            showmsg(control_returnCode::FORM_SUBMIT_TRUE);        }    }}